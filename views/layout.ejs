<!DOCTYPE html>
<html lang="ca-ES">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>appEscola</title>
<!--    <link rel="shortcut icon" type="image/png" href="favicon.png">-->
     <!-- Font Awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- CSS de Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    <!-- Material Design Bootstrap -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.3.0/css/mdb.min.css" rel="stylesheet">
    <!-- CSS de Bootstrap-DATEPICKER -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/css/bootstrap-datepicker3.css" rel="stylesheet"/>
    <!-- CSS -->
    <link href="/stylesheets/css/style.css" rel="stylesheet" media="screen">
  </head>

  <body>
  <%  
  if (session.user){
    var horari = session.user.horari;
      var ruta;
      if(session.user.mestre === "ee"){
      ruta = "/list_EE";
      } else {
        ruta = "/list";
    }
    } else {
      ruta = "";
    }
  %>

<!--Navbar-->
    <nav class="navbar navbar-toggleable-md navbar-dark black fixed-top z-depth-0 scrolling-navbar">
      <div class="container">
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarNav1" aria-controls="navbarNav1" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <a class="navbar-brand" href="<%=ruta%>">
          <strong>appEscola</strong>
        </a>
        <div class="collapse navbar-collapse" id="navbarNav1">       
          <%if (!session.user){%>
            <ul class="nav navbar-nav ml-auto">
              <li class="nav-item dropdown btn-group">
                <a class="nav-link dropdown-toggle" id="nouUser" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-user"></i> Nou usuari/a </a>
                <div class="dropdown-menu dropdown" aria-labelledby="nouUser">
                  <!--
                <a class="dropdown-item" data-toggle="modal" id="btnEscola" href="/javascripts/modals/nouEscola.ejs" data-target="#escolaModal" role="button">Nova escola</a>
              -->
                <a class="dropdown-item" data-toggle="modal" id="btnUser" href="/javascripts/modals/nouRegistre.ejs" data-target="#userModal" role="button">Nou tutor/a</a>
                <a class="dropdown-item" data-toggle="modal" id="btnUsee" href="/javascripts/modals/nouRegistreEe.ejs" data-target="#useeModal" role="button">Nou tutor/a EE-SIEI</a>
                </div>
              </li>
              <li class="nav-item">
                <a class="nav-link" data-toggle="modal" id="btnAssist" href="/javascripts/modals/login.ejs" data-target="#loginModal"><i class="fa fa-sign-in"></i> Entra</a>
              </li>
            </ul>
            <%} else {%>
              <ul class="navbar-nav mr-auto offset-md-1">
                <li id="llista" class="nav-item"><a class="nav-link" href="<%=ruta%>">Llistes<span class="sr-only">(current)</span></a></li>
                <%if(session.user.mestre === "tutor"){%>
                  <li id="tutoria" class="nav-item hidBig"><a class="nav-link" href="/list">Tutoria</a></li>
                  <li id="assistencia" class="nav-item hidBig"><a class="nav-link" href="/assistencia">Assistència</a></li>
                  <li id="menjador" class="nav-item hidBig"><a class="nav-link" href="/menjador">Menjador</a></li>
                  <%}%>
                  <% if (!session.user.horari) {%>
                    <li id="crearHoraris" class="nav-item"><a class="nav-link" data-toggle="modal" id="btnCreaHorari" href="/javascripts/modals/creaHorari.ejs" data-target="#creaHorariModal">Crear Horari</a></li>
                    <%} else {%>
                    <li id="horari-menu" class="nav-item"><a class="nav-link" href="/horari-diari">Horaris</a></li>
                    <li id="configHorari" class="nav-item hidBig"><a class="nav-link" href="/horari-config">Configurar horari</a></li>
                    <li id="diariHorari" class="nav-item hidBig"><a class="nav-link" href="/horari-diari">Horari diari</a></li>                 
                <%}%>
              </ul>
            
              <ul class="navbar-nav">
                <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle" id="userDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><%=" "+ "Hola, " + session.user.nom +" "+ session.user.cognom%></a>
                  <div class="dropdown-menu" aria-labelledby="userDropdown">
                    <a class="dropdown-item" href="/usuari/<%=session.user._id%>">El meu perfil</a>
                    <a class="dropdown-item" href="/logout">Sortir</a>
                  </div>
                </li>
              </ul>
          <%}%>
        </div>
    </div>
  </nav>
<%if (session.user) {%>
  <aside class="col-md-2 sidebar hid">
    <%if (session.user.mestre==="ee") {%>
      <div class="col-md-12 curs-t" id="situee">Atenció a la DIVERSITAT</div>
    <%}%>
    <div class="col-md-12 curs-t" id="situ"></div>
    <%if (session.user.mestre==="tutor") {%>
      <div class="col-md-12 curs-t"><%=session.user.curs%></div>
    <%}%>
      <div class="col-md-12 hid sidelink" id="a1div">
        <a id="a1"></a>
          <button type="submit" form = "horari_post" class="btn btn-dark-green buttonSide hidDrop" id="configDiariPost">Desa</button>
      </div>
      <div class="col-md-12 hid sidelink" id="a2div">
        <a id="a2"></a>
          <button type="submit" form = "horari_post" class="btn btn-dark-green buttonSide hidDrop" id="horariDiariPost">Desa</button>
      </div>
      <div class="col-md-12 hid sidelink" id="a3div"><a id="a3"></a></div>
      <div class="col-md-12 hid sidelink" id="a4div"><a id="a4"></a></div>

      <div class="nav-item dropdown hidDrop" id="areasDrop">
        <a class="nav-link dropdown-toggle" id="areasDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Àrees</a>
        <%if (session.user.horari) {%>
        <div class="dropdown-menu" aria-labelledby="areasDropdown">
          <% console.log("ARRAY:  " + session.user.horari.areasArray.length);
          for (var i = 0; i < session.user.horari.areasArray.length; i++) { %>
            <a class="dropdown-item" href="#"><%=session.user.horari.areasArray[i]%></a>
          <% } %>
        </div>
        <% } %>
      </div>

  </aside>
<%}%>

  <section class ="mainsection">
    <%- body %>
  </section>

  <footer class="footer">
    <div class="container-fluid">
      <div class="row">

          <!--First column-->
          <div class="col-md-5 offset-md-2">
              <h5 class="title">Segueix-nos</h5>
              <div class="row">
              <div class="col-md-2">
              <a href="https://facebook.com" target="_blank"><i class="fa fa-facebook-official fa-2x" aria-hidden="true"></i></a>

              <a href="https://twitter.com/appescola" target="_blank"><i class="fa fa-twitter-square fa-2x" aria-hidden="true"></i></a>
              </div>
              </div>
          </div>
          <!--/.First column-->

          <!--Second column-->
          <!--/.Footer Links-->
          <div class="col-md-5">
              <h5 class="title">Aquesta app està feta amb:</h5>
              <ul>
                  <li><a href="https://nodejs.org/es/">Node JS</a></li>
                  <li><a href="https://www.mongodb.com/es">MongoDB</a></li>
                  <li><a href="http://getbootstrap.com/">Bootstrap</a></li>
                  <li><a href="https://angular.io/">Angular (properament)</a></li>
                  
              </ul>

          </div>
          <!--/.Second column-->
      </div>
<!--Copyright-->
      <div class="footer-copyright">
        <div class="row">
          <div class="col-md-6">
            © 2017 <a href="https://twitter.com/appescola"> appEscola </a>
          </div>
          <div class="col-md-6">Versió Beta 1.1</div>
        </div>      
      </div>
    <!--/.Copyright-->
    </div>
  </footer>

 <!-- MODAL NOU TUTOR -->
  <div class="modal fade" id="userModal" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content">
      </div>
    </div>
  </div>

<!-- MODAL LOGIN-->
  <div class="modal fade" id="loginModal" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content">
      </div>
    </div>
  </div> 

<!-- MODAL NOVA ESCOLA -->
  <div class="modal fade" id="escolaModal" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content">
      </div>
    </div>
  </div> 

<!-- MODAL NOU MESTRE USEE-->
  <div class="modal fade" id="useeModal" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content">
      </div>
    </div>
  </div>

<!-- MODAL CREAR HORARI-->
  <div class="modal fade" id="creaHorariModal" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content">
      </div>
    </div>
  </div>

<!-- Librería jQuery requerida por los plugins de JavaScript -->
  <script
  src="https://code.jquery.com/jquery-3.1.1.js"
  integrity="sha256-16cdPddA6VdVInumRGo6IbivbERE8p7CQR3HzTBuELA="
  crossorigin="anonymous"></script>
<!-- Tether.js -->
  <script src="/stylesheets/plugins/tether.min.js"></script>
<!-- Bootstrap.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
  <!-- MDB core JavaScript -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.3.0/js/mdb.min.js"></script>
<!-- Datepicker -->  
  <script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/js/bootstrap-datepicker.js"></script>
  <script type="text/javascript" src="/stylesheets/plugins/bootstrap-datepicker/js/bootstrap-datepicker.ca.min.js"></script>
<!-- Spinner -->
  <script src="//cdn.jsdelivr.net/jquery.loadingoverlay/1.5.3/loadingoverlay.min.js"></script>
<!-- Fichero externo con JS y jQuery -->
  <script src="/javascripts/global.js"></script>
  <script src="/javascripts/seguiment.js"></script>
  <script src="/javascripts/horari.js"></script>

</body>
</html>